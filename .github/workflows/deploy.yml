# .github/workflows/deploy.yml
name: Deploy to GitHub Pages (Arch Linux)

on:
  # main ë¸Œëœì¹˜ì— push í•  ë•Œ ì‹¤í–‰
  push:
    branches:
      - main
  # Actions íƒ­ì—ì„œ ìˆ˜ë™ìœ¼ë¡œ ì‹¤í–‰
  workflow_dispatch:

jobs:
  build_and_deploy:
    # ğŸš¨ **ì´ ë¶€ë¶„**ì„ ì¶”ê°€í•´ì•¼ í•©ë‹ˆë‹¤! ğŸš¨
    permissions:
      contents: write # ${{ secrets.GITHUB_TOKEN }}ì´ ë¸Œëœì¹˜ì— í‘¸ì‹œí•  ìˆ˜ ìˆë„ë¡ ì“°ê¸° ê¶Œí•œ ë¶€ì—¬

    # GitHubì˜ Ubuntu í™˜ê²½ì—ì„œ ì‹¤í–‰ë˜ì§€ë§Œ,
    # ëª¨ë“  ì‘ì—… ë‹¨ê³„(steps)ëŠ” ì•„ë˜ì˜ Arch Linux ì»¨í…Œì´ë„ˆ ì•ˆì—ì„œ êµ¬ë™ë©ë‹ˆë‹¤.
    runs-on: ubuntu-latest
    container:
      image: archlinux:latest

    steps:
      # 1. GitHub Actionì—ì„œ ì‚¬ìš©í•  ì†ŒìŠ¤ ì½”ë“œë¥¼ ì²´í¬ì•„ì›ƒí•©ë‹ˆë‹¤.
      - name: Checkout
        uses: actions/checkout@v4

      # 2. Arch Linuxì˜ íŒ¨í‚¤ì§€ ë§¤ë‹ˆì €(pacman)ë¡œ í•„ìš”í•œ ë„êµ¬ë¥¼ ì„¤ì¹˜í•©ë‹ˆë‹¤.
      - name: Install Dependencies
        run: |
          pacman -Syu --noconfirm
          pacman -S --noconfirm zola git

      # 3. Zolaë¥¼ ì‚¬ìš©í•´ ì›¹ì‚¬ì´íŠ¸ë¥¼ ë¹Œë“œí•©ë‹ˆë‹¤.
      - name: Build site
        run: zola build

      # 4. 'public' í´ë”ì˜ ë‚´ìš©ì„ GitHub Pagesì— ë°°í¬í•©ë‹ˆë‹¤.
      - name: Deploy
        uses: peaceiris/actions-gh-pages@v4
        with:
          github_token: ${{ secrets.GITHUB_TOKEN }}
          publish_dir: ./public
          commit_message: ${{ github.event.head_commit.message }}
