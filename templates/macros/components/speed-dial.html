{% macro speed_dial() %}
<div class="speed-dial">
  <button class="trigger" id="sd-trigger" aria-label="Open speed dial" popovertarget="sd-menu">
    {{ icons::plus(size=6, class="icon-plus") }}
  </button>
  
  <div id="sd-menu" popover class="dial">
    <button class="item theme-btn" aria-label="Toggle theme" onclick="toggleTheme()">
      <div class="inner">
        <div class="sun-icon">{{ icons::sun(size=5) }}</div>
        <div class="moon-icon">{{ icons::moon(size=5) }}</div>
      </div>
    </button>
    
    <button class="item search-btn" aria-label="Search">
      <div class="inner">{{ icons::search(size=5) }}</div>
    </button>
    
    <button class="item top-btn" aria-label="Scroll to top" onclick="window.scrollTo({top: 0, behavior: 'smooth'})">
      <div class="inner">{{ icons::top(size=5) }}</div>
    </button>
    
    <a href="/atom.xml" class="item rss-btn" aria-label="RSS Feed">
      <div class="inner">{{ icons::rss(size=5) }}</div>
    </a>
    
    <button class="item share-btn" aria-label="Share" onclick="sharePage()">
      <div class="inner">{{ icons::share(size=5) }}</div>
    </button>
  </div>
</div>

<script>
  function toggleTheme() {
    const html = document.documentElement;
    const currentTheme = html.getAttribute('data-theme');
    const newTheme = currentTheme === 'lofi' ? 'dim' : 'lofi';
    html.setAttribute('data-theme', newTheme);
    localStorage.setItem('theme', newTheme);
  }

  function sharePage() {
    if (navigator.share) {
      navigator.share({
        title: document.title,
        url: window.location.href
      }).catch(console.error);
    } else {
      navigator.clipboard.writeText(window.location.href);
      alert('Link copied to clipboard!');
    }
  }

  // Set theme on load
  (function() {
    const savedTheme = localStorage.getItem('theme');
    if (savedTheme) {
      document.documentElement.setAttribute('data-theme', savedTheme);
    }
  })();
</script>
{% endmacro %}
