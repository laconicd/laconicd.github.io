{% extends "base.html" %}

{% block content %}
<post-detail-view>
  <template shadowrootmode="open">
    <style>
      .container {
        width: 100%;
        padding: 2rem 0;
      }

      @media (min-width: 768px) {
        .container {
          padding: 3rem 0;
        }
      }

      .header {
        margin-bottom: 2.5rem;
        text-align: center;
      }

      @media (min-width: 768px) {
        .header {
          margin-bottom: 4rem;
        }
      }

      .featured-image {
        margin-bottom: 2.5rem;
        aspect-ratio: 16 / 9;
        border-radius: 1.5rem;
        overflow: hidden;
        box-shadow: 0 25px 50px -12px rgb(0 0 0 / 0.25);
        border: 1px solid var(--fallback-b2, oklch(var(--b2)));
      }

      @media (min-width: 768px) {
        .featured-image {
          margin-bottom: 4rem;
          border-radius: 2.25rem;
        }
      }

      .content {
        margin-bottom: 4rem;
      }

      .footer {
        padding-top: 3rem;
        border-top: 1px solid var(--fallback-b2, oklch(var(--b2)));
      }
    </style>
    <article class="container">
      <header class="header">
        <slot name="header"></slot>
      </header>

      <div class="featured-image">
        <slot name="image"></slot>
      </div>

      <div class="content">
        <slot></slot>
      </div>

      <footer class="footer">
        <slot name="footer-tags"></slot>
        <slot name="footer-nav"></slot>
      </footer>
    </article>
  </template>

  <!-- Post Header -->
  <div slot="header">
    <div
      class="flex items-center justify-center gap-3 mb-4 md:mb-6 text-[10px] md:text-xs font-black uppercase tracking-widest text-primary">
      {% if page.taxonomies.categories %}
      {% for cat in page.taxonomies.categories %}
      <span>{{ cat }}</span>
      {% endfor %}
      {% endif %}
      <span class="opacity-30">â€¢</span>
      <time class="opacity-50" datetime="{{ page.date }}">{{ page.date | date(format="%B %d, %Y") }}</time>
    </div>

    <h1 class="text-3xl md:text-6xl font-black tracking-tighter leading-tight mb-6 md:mb-8 px-2">
      {{ page.title }}
    </h1>

    <div class="flex items-center justify-center gap-3 md:gap-4">
      <div class="avatar">
        <div class="size-10 md:size-12 rounded-2xl ring ring-base-200 ring-offset-2 md:ring-offset-4">
          <img src="{{ get_url(path=config.extra.author_avatar) | safe }}" alt="{{ config.extra.author_name }}" />
        </div>
      </div>
      <div class="text-left">
        <div class="text-xs md:text-sm font-black uppercase tracking-widest text-base-content">{{
          config.extra.author_name }}</div>
        <div class="text-[10px] md:text-xs opacity-40 font-bold uppercase">{{ config.extra.author_role }}</div>
      </div>
    </div>
  </div>

  <!-- Featured Image -->
  <div slot="image" class="w-full h-full">
    {% if page.extra.image %}
    {% set image_path = page.relative_path | replace(from="index.md", to=page.extra.image) %}
    {% set resized = resize_image(path=image_path, width=1200, height=675, op="fill", format="webp", quality=90) %}
    <img src="{{ resized.url }}" alt="{{ page.title }}" class="w-full h-full object-cover" loading="eager" />
    {% else %}
    <img src="{{ get_url(path='images/default-post.jpg') }}" alt="{{ page.title }}"
      class="w-full h-full object-cover opacity-90" />
    {% endif %}
  </div>

  <!-- Content -->
  <div
    class="prose prose-lg max-w-none 
              prose-headings:font-black prose-headings:tracking-tighter 
              prose-a:text-primary prose-a:no-underline hover:prose-a:underline
              prose-img:rounded-3xl prose-img:shadow-xl
              prose-code:bg-base-200 prose-code:px-1.5 prose-code:py-0.5 prose-code:rounded-md prose-code:before:content-none prose-code:after:content-none">
    {{ page.content | safe }}
  </div>

  <!-- Footer Tags -->
  <div slot="footer-tags">
    {% if page.taxonomies.tags %}
    <div class="flex flex-wrap gap-2 mb-16">
      {% for tag in page.taxonomies.tags %}
      <a href="{{ get_taxonomy_url(kind='tags', name=tag) }}"
        class="badge badge-lg badge-ghost font-bold opacity-50 hover:opacity-100 transition-opacity">
        #{{ tag }}
      </a>
      {% endfor %}
    </div>
    {% endif %}
  </div>

  <!-- Footer Navigation -->
  <div slot="footer-nav" class="grid grid-cols-1 md:grid-cols-2 gap-4 md:gap-6">
    {% if page.lower %}
    <a href="{{ page.lower.path }}"
      class="group p-6 md:p-8 bg-base-100 border border-base-200 rounded-3xl hover:shadow-xl transition duration-300"
      data-transition="back">
      <div
        class="text-[10px] md:text-xs font-black uppercase tracking-widest opacity-30 mb-2 group-hover:text-primary transition-colors">
        Previous Post</div>
      <div class="text-base md:text-lg font-black tracking-tight line-clamp-1">{{ page.lower.title }}</div>
    </a>
    {% endif %}

    {% if page.higher %}
    <a href="{{ page.higher.path }}"
      class="group p-6 md:p-8 bg-base-100 border border-base-200 rounded-3xl text-right hover:shadow-xl transition duration-300"
      data-transition="slide">
      <div
        class="text-[10px] md:text-xs font-black uppercase tracking-widest opacity-30 mb-2 group-hover:text-primary transition-colors">
        Next Post</div>
      <div class="text-base md:text-lg font-black tracking-tight line-clamp-1">{{ page.higher.title }}</div>
    </a>
    {% endif %}
  </div>
</post-detail-view>
{% endblock content %}