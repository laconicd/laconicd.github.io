{% import "macros/icons.html" as icons %}
<app-navbar>
  <template shadowrootmode="open">
    <style>
      :host {
        width: 100%;
        display: block;
      }

      .navbar {
        display: flex;
        align-items: center;
        min-height: 4rem;
      }
    </style>
    <nav aria-label="Main navigation" class="navbar">
      <slot name="brand"></slot>
      <slot name="menu"></slot>
      <slot name="drawer-toggle"></slot>
    </nav>
  </template>

  <div slot="brand" class="justify-start flex-1 text-xl font-bold tracking-tight px-2 sm:px-4">
    <a href="/" class="btn btn-ghost btn-xl">{{ config.title }}</a>
  </div>

  <!-- Theme Toggle (Now only visible on desktop via sm:block container) -->
  <div slot="menu" class="hidden sm:flex items-center gap-1 justify-end">
    <a href="{{ get_url(path='@/posts/_index.md') }}" class="btn btn-ghost btn-sm">Posts</a>
    <a href="{{ get_url(path='categories') }}" class="btn btn-ghost btn-sm">Categories</a>
    <a href="{{ get_url(path='tags') }}" class="btn btn-ghost btn-sm">Tags</a>
    
    <!-- Vertical Divider -->
    <div class="w-px h-4 bg-base-content/60 mx-2"></div>

    <div class="flex items-center gap-1">
      <!-- Search Button (Icon only) -->
      <button id="navbar-search-btn" class="btn btn-ghost btn-sm btn-circle" aria-label="Search">
        {{ icons::search() }}
      </button>

      <!-- RSS Feed -->
      <a href="{{ get_url(path='rss.xml') }}" target="_blank" class="btn btn-ghost btn-sm btn-circle" aria-label="RSS Feed">
        {{ icons::rss() }}
      </a>

      <!-- Theme Toggle -->
      <label class="swap swap-rotate btn btn-ghost btn-sm btn-circle">
        <input type="checkbox" class="theme-controller" value="dim" />
        {{ icons::sun(size=5, class="swap-off") }}
        {{ icons::moon(size=5, class="swap-on") }}
      </label>
    </div>
  </div>

  <script>
    (function() {
      const setup = () => {
        const searchBtn = document.getElementById('navbar-search-btn');
        const modal = document.getElementById('search_modal');
        if (searchBtn && modal) {
          searchBtn.onclick = () => modal.showModal();
        }
      };
      setup();
      window.addEventListener('page:updated', setup);
    })();
  </script>

  <!-- Hamburger Menu (Drawer Toggle) -->
  <label slot="drawer-toggle" for="mobile-drawer" class="btn btn-ghost btn-sm btn-circle sm:hidden ml-1">
    {{ icons::menu() }}
  </label>
</app-navbar>
