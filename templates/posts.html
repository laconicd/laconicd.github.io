{% extends "base.html" %}
{% import "macros/icons.html" as icons %}

{% block content %}
<div class="app-posts">
  <header class="app-posts-header">
    <h1>{{ section.title }}</h1>
    <p>Thoughts, stories, and ideas. A collection of writings on technology, design, and everything in between.</p>
  </header>

  {% set blog_section = get_section(path="posts/_index.md") %}

  {% if blog_section.pages | length > 0 %}
  {# Latest Post as Featured #}
  {% set featured = blog_section.pages[0] %}
  <section class="featured-section">
    <a href="{{ featured.path }}" class="featured-card">
      <div class="featured-image">
        {% if featured.extra.image %}
        {% set path_parts = featured.relative_path | split(pat="/") %}
        {% set dir_path = path_parts | slice(end=-1) | join(sep="/") %}
        {% set image_path = "static/media/" ~ dir_path ~ "/" ~ featured.extra.image %}
        {% set thumb = resize_image(path=image_path, width=1200, height=800, op="fill") %}
        <img src="{{ thumb.url }}" alt="{{ featured.title }}" loading="lazy">
        {% else %}
        <img src="{{ get_url(path='images/default-post.jpg') }}" alt="" loading="lazy">
        {% endif %}
      </div>
      <div class="featured-content">
        <span class="featured-badge">Featured</span>
        <h2>{{ featured.title }}</h2>
        <p>{{ featured.summary | default(value=featured.description) | default(value="") | striptags | safe }}</p>
        <div class="featured-footer">
          <span>Keep Reading</span>
          <span class="arrow btn-icon-circle">{{ icons::arrow_right(size=4) }}</span>
        </div>
      </div>
    </a>
  </section>

  <div class="grid-divider">
    <hr>
    <span>The Archive</span>
    <hr>
  </div>

  <div class="app-posts-grid">
    {% for page in blog_section.pages | slice(start=1) %}
    {% include "partials/post-grid-card.html" %}
    {% endfor %}
  </div>
  {% else %}
  <div style="padding: 8rem 0; text-align: center;">
    <p style="font-size: 1.5rem; font-weight: bold; opacity: 0.2; font-style: italic;">The ink hasn't dried yet...</p>
  </div>
  {% endif %}
</div>
{% endblock content %}