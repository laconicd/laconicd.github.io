{% extends "base.html" %}
{% import "macros/icons.html" as icons %}

{% block content %}

<style>
  @scope(.app-posts) {
    :scope {
      display: grid;
      gap: 5rem;
      padding-bottom: 5rem;
      padding-left: 1.25rem;
      padding-right: 1.25rem;
      max-width: 80rem;
      margin-left: auto;
      margin-right: auto;

      @media (width < 48rem) {
        gap: 3rem;
      }
    }

    /* Brand Header Section */
    & .app-posts-header {
      display: grid;
      justify-items: center;
      text-align: center;
      margin-top: 3rem;
      animation: fadeInDown 0.8s var(--ease-standard);

      & h1 {
        font-size: clamp(3.5rem, 8vw, 6rem);
        font-weight: 800;
        letter-spacing: -0.05em;
        line-height: 1.2;
        padding: 0.05em 0.1em;
        margin-bottom: 1.5rem;
        background: linear-gradient(to bottom, var(--color-base-content) 50%, oklch(from var(--color-base-content) l c h / 0.2));
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
      }

      & p {
        font-size: clamp(1.1rem, 2vw, 1.5rem);
        color: oklch(from var(--color-base-content) l c h / 0.5);
        font-style: italic;
        max-width: 35rem;
        line-height: 1.4;
      }
    }

    /* Featured Post Highlight */
    & .featured-section {
      animation: fadeInUp 1s var(--ease-standard) 0.2s both;
      
      & .featured-card {
        display: grid;
        grid-template-columns: 1.3fr 0.7fr;
        background: var(--color-base-200);
        border-radius: 2.5rem;
        overflow: hidden;
        min-height: 35rem;
        box-shadow: 0 0 0 1px oklch(from var(--color-base-content) l c h / 0.05);
        transition: all 0.5s var(--ease-standard);

        &:hover {
          transform: translateY(-6px);
          box-shadow: var(--shadow-4);
          & .featured-image img { transform: scale(1.05); }
          & .featured-footer .arrow { transform: translateX(6px); }
        }

        & .featured-image {
          position: relative;
          overflow: hidden;
          width: 100%;
          height: 100%;
          & img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.8s cubic-bezier(0.2, 1, 0.3, 1);
          }
        }

        & .featured-content {
          padding: 4rem;
          display: flex;
          flex-direction: column;
          justify-content: center;
          gap: 2rem;

          & .featured-badge {
            align-self: flex-start;
            background: var(--color-primary);
            color: var(--color-primary-content);
            font-size: 0.75rem;
            font-weight: 900;
            text-transform: uppercase;
            letter-spacing: 0.1em;
            padding: 0.6rem 1.2rem;
            border-radius: 99px;
          }

          & h2 {
            font-size: clamp(2rem, 4vw, 3.5rem);
            font-weight: 900;
            line-height: 1;
            letter-spacing: -0.03em;
          }

          & p {
            font-size: 1.2rem;
            line-height: 1.6;
            opacity: 0.6;
            display: -webkit-box;
            -webkit-line-clamp: 4;
            -webkit-box-orient: vertical;
            overflow: hidden;
          }

          & .featured-footer {
            display: flex;
            align-items: center;
            gap: 1.5rem;
            margin-top: 1rem;
            font-weight: 800;
            font-size: 1rem;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            
            & .arrow { 
              display: flex;
              align-items: center;
              justify-content: center;
              width: 2.5rem;
              height: 2.5rem;
              border-radius: 50%;
              background: var(--color-base-content);
              color: var(--color-base-100);
              transition: transform 0.3s var(--ease-standard); 
            }
          }
        }

        @media (width < 64rem) {
          grid-template-columns: 1fr;
          min-height: auto;
          & .featured-content { padding: 3rem; }
          & .featured-image { aspect-ratio: 16/10; }
        }

        @media (width < 48rem) {
          display: flex;
          flex-direction: column;
          border-radius: 1.5rem;
          
          & .featured-image {
            width: 100%;
            aspect-ratio: 16/9;
            height: auto;
          }

          & .featured-content { 
            padding: 2rem; 
            gap: 1.25rem;
          }
          
          & h2 { font-size: 1.75rem; }
          & p { font-size: 1rem; -webkit-line-clamp: 3; }
          & .featured-footer { font-size: 0.8rem; }
        }
      }
    }

    /* Main Grid Section */
    & .app-posts-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(22rem, 1fr));
      gap: 4rem 3rem;
      animation: fadeInUp 1s var(--ease-standard) 0.4s both;
      
      @media (width < 48rem) {
        grid-template-columns: 1fr;
        gap: 3rem;
      }
    }

    /* Divider */
    & .grid-divider {
      display: flex;
      align-items: center;
      gap: 2.5rem;
      margin: 1rem 0;
      animation: fadeIn 1.5s var(--ease-standard) 0.6s both;
      
      & hr { flex: 1; border: none; border-top: 1px solid oklch(from var(--color-base-content) l c h / 0.1); }
      & span {
        font-size: 0.8rem;
        font-weight: 900;
        text-transform: uppercase;
        letter-spacing: 0.3em;
        opacity: 0.25;
      }
    }

    /* Animations */
    @keyframes fadeInDown {
      from { opacity: 0; transform: translateY(-20px); }
      to { opacity: 1; transform: translateY(0); }
    }
    @keyframes fadeInUp {
      from { opacity: 0; transform: translateY(30px); }
      to { opacity: 1; transform: translateY(0); }
    }
    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }
  }
</style>

<div class="app-posts">
  <header class="app-posts-header">
    <h1>{{ section.title }}</h1>
    <p>Thoughts, stories, and ideas. A collection of writings on technology, design, and everything in between.</p>
  </header>

  {% set blog_section = get_section(path="posts/_index.md") %}
  
  {% if blog_section.pages | length > 0 %}
    {# Latest Post as Featured #}
    {% set featured = blog_section.pages[0] %}
    <section class="featured-section">
      <a href="{{ featured.path }}" class="featured-card">
        <div class="featured-image">
          {% if featured.extra.image %}
            {% set image_path = featured.relative_path | replace(from="index.md", to=featured.extra.image) %}
            {% set thumb = resize_image(path=image_path, width=1200, height=800, op="fill") %}
            <img src="{{ thumb.url }}" alt="{{ featured.title }}" loading="lazy">
          {% else %}
            <img src="{{ get_url(path='images/default-post.jpg') }}" alt="" loading="lazy">
          {% endif %}
        </div>
        <div class="featured-content">
          <span class="featured-badge">Featured</span>
          <h2>{{ featured.title }}</h2>
          <p>{{ featured.summary | default(value=featured.description) | default(value="") | striptags | safe }}</p>
          <div class="featured-footer">
            <span>Keep Reading</span>
            <span class="arrow">{{ icons::arrow_right(size=4) }}</span>
          </div>
        </div>
      </a>
    </section>

    <div class="grid-divider">
      <hr>
      <span>The Archive</span>
      <hr>
    </div>

    <div class="app-posts-grid">
      {% for page in blog_section.pages | slice(start=1) %}
      {% include "partials/post-grid-card.html" %}
      {% endfor %}
    </div>
  {% else %}
    <div class="py-32 text-center">
      <p class="text-2xl font-bold opacity-20 italic">The ink hasn't dried yet...</p>
    </div>
  {% endif %}
</div>
{% endblock content %}
